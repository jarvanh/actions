name: douyin
on:
  schedule:
    - cron: '0 * * * *'
  workflow_dispatch:
  watch:
    types: started

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: rclone-install
        run: |
          # ÂÆâË£Ö rclone
          # curl -O https:/./Downloads.rclone.org/rclone-current-linux-amd64.zip
          # curl -O https://beta.rclone.org/rclone-beta-latest-linux-amd64.zip
          # unzip rclone-*-amd64.zip
          # cd rclone-*-linux-amd64
          # sudo mv rclone /usr/bin
          # sudo chmod +x /usr/bin/rclone
          sudo apt-get install rclone
      - name: rclone-config
        env:
          RCLONE_CONFIG: ${{ secrets.RCLONE }}
        run: |
          # ÂÜôÈÖçÁΩÆÊñá‰ª∂
          mkdir -p ~/.config/rclone/
          cat << EOF > ~/.config/rclone/rclone.conf
          $RCLONE_CONFIG
          EOF
      - name: rclone-run
        run: |
          sudo apt-get install fuse3
          sudo mkdir /onedrive
          sudo nohup rclone mount onedrive: /onedrive --allow-non-empty --no-gzip-encoding --umask 000 --allow-other --attr-timeout 10m --vfs-cache-mode full --vfs-cache-max-age 5m --vfs-read-chunk-size-limit 10G --buffer-size 100M --vfs-cache-max-size 50G &
          echo "==========onedrive==========="
          rclone lsf onedrive:
          echo "==========dropbox==========="
          rclone lsf dropbox:
      - name: run douyin
        run: |
          sudo apt-get update
          sudo timedatectl set-timezone Asia/Shanghai
          timedatectl

          cd /onedrive/backup/douyin
          rm -rf /logs
          pip install f2
          # ÂàùÂßãÂåñÊäñÈü≥ÈÖçÁΩÆÊñá‰ª∂
          # f2 dy --init-config /onedrive/backup/douyin/douyin.yaml
          # ‰∏ãËΩΩÁöÑÊó∂ÂÄô‰ΩøÁî®ÊäñÈü≥ÈÖçÁΩÆÊñá‰ª∂Êèê‰æõcookie
          # !f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://v.douyin.com/iL1rgUuG --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all
          # ÊàñËÄÖ --cookie "your douyin cookie" ËæìÂÖ•cookie
          # !f2 dy --cookie "your douyin cookie" --url https://v.douyin.com/iL1rgUuG --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all

          # Áî®Êà∑‰∏ªÈ°µ(ÈùûËßÜÈ¢ëÈìæÊé•)
          # Awu
          # https://v.douyin.com/iL1rgUuG
          f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://v.douyin.com/iL1rgUuG --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"

          # # Saber
          # # uid = https://www.douyin.com/user/MS4wLjABAAAADdqSYeEX6BTn_jQ_THNEDECn2oH5jkfUq1bLTHF6gzA
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://www.douyin.com/user/MS4wLjABAAAADdqSYeEX6BTn_jQ_THNEDECn2oH5jkfUq1bLTHF6gzA --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"

          # # ËµµÊ∞¥Ëé≤
          # # https://v.douyin.com/iL1rBxQN
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://v.douyin.com/iL1rBxQN --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"
          # # https://v.douyin.com/iLJFU7pC
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://v.douyin.com/iLJFU7pC --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"

          # # ‰ΩïÈáëÁé≤
          # # https://v.douyin.com/iL1rjFCd
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://v.douyin.com/iL1rjFCd --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"

          # # Auto parts-Jessy üöó
          # # https://v.douyin.com/i8oTnRfK
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://v.douyin.com/i8oTnRfK --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"

          # # Âí©Âí©Â∞èi
          # # uid = https://www.douyin.com/user/MS4wLjABAAAAwW6vDX_a-o7_I4pA1a01uctdLHVm_tjGoiIiDMSGHl7MeG_gc138NrNM_dJ7LRPK
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://www.douyin.com/user/MS4wLjABAAAAwW6vDX_a-o7_I4pA1a01uctdLHVm_tjGoiIiDMSGHl7MeG_gc138NrNM_dJ7LRPK --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"
          # # uid = https://v.douyin.com/i8tohAuj
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://v.douyin.com/i8tohAuj --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"
          
          # # Á®ãÁ®ãCc
          # # uid = https://v.douyin.com/i8toAVY6
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://v.douyin.com/i8toAVY6 --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"
          # # uid = https://v.douyin.com/i8to55Db
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://v.douyin.com/i8to55Db --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"
          
          # # ÁàÜÁÇ∏Â∞èËÑëË¢ã
          # # https://v.douyin.com/iL1hhtwy
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://v.douyin.com/iL1hhtwy --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"
          # # https://v.douyin.com/iL1hLVud
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://v.douyin.com/iL1hLVud --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"

          # # ‰πêÊÄ°leyi
          # # https://www.douyin.com/user/MS4wLjABAAAAQlV4nWmUMeCBUAvFzlQlbDzhALDob7IyvOkgh6dZtXk
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://www.douyin.com/user/MS4wLjABAAAAQlV4nWmUMeCBUAvFzlQlbDzhALDob7IyvOkgh6dZtXk --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"

          # # ÊÉ†Â∑û‰∏âÊ†ã‰∏≠ÂøÉÔΩúÊñπÁ®ãË±πÊ±ΩËΩ¶
          # # https://www.douyin.com/user/MS4wLjABAAAAkLJitaneImKuy2DoaGbE1ut9oipJqntXJjAN5poypVRcmYJbdY6H7RiNl1EDUYEC
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://www.douyin.com/user/MS4wLjABAAAAkLJitaneImKuy2DoaGbE1ut9oipJqntXJjAN5poypVRcmYJbdY6H7RiNl1EDUYEC --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"

          # # ÊØî‰∫öËø™Ê±ΩËΩ¶ÁéãÊúùÁΩëÔºàÊ∞∏ÂòâÁ••Èæô4SÂ∫óÔºâ
          # # https://www.douyin.com/user/MS4wLjABAAAAtEJce6ucILs8WFiGZtsoeXLE67irCYvBh9SuanB_J3QCqvRQNSNl5Dx7S8JPetHI
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://www.douyin.com/user/MS4wLjABAAAAtEJce6ucILs8WFiGZtsoeXLE67irCYvBh9SuanB_J3QCqvRQNSNl5Dx7S8JPetHI --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"

          # # Êµ∑ÂçóÂ••ÂàõÂù¶ÂÖãÊ±ΩËΩ¶
          # # https://www.douyin.com/user/MS4wLjABAAAAWShK_6twehp3yafhNAdl_y42DKAENamAXZkIRc1ymqs
          # f2 dy -c /onedrive/backup/douyin/douyin.yaml --url https://www.douyin.com/user/MS4wLjABAAAAWShK_6twehp3yafhNAdl_y42DKAENamAXZkIRc1ymqs --mode post --path ./Download --music yes --cover yes --desc yes --folderize yes --interval all || echo "Â§±Ë¥•"
     
          echo "github douyin ‰ªªÂä°ÊâßË°åÁªìÊùü"
          curl -s -X POST https://api.telegram.org/bot'${{ secrets.TELEGRAM_BOT_TOKEN }}'/sendMessage -d chat_id='${{ secrets.TELEGRAM_CHAT_ID }}' -d text="github douyin ‰ªªÂä°ÊâßË°åÁªìÊùü"
